<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Send</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="wrapper">

  <!-- preview -->
  <img id="preview" style="
    width:100%;
    max-height:220px;
    object-fit:cover;
    border-radius:14px;
    margin-bottom:14px;
    display:none;
  ">

  <input type="file" id="img" accept="image/*">
  <input id="msg" placeholder="à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡">
  <input id="ig" placeholder="@ig">
  <button onclick="send()">à¸ªà¹ˆà¸‡</button>

</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyC4aqYP4YFPkaXE6039rnS6kgyDklt5ujA",
    authDomain: "test-706cb.firebaseapp.com",
    databaseURL: "https://test-706cb-default-rtdb.firebaseio.com",
    projectId: "test-706cb",
    appId: "1:897043689098:web:b6d6d629d2ae72150b0773"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const imgInput = document.getElementById("img");
  const preview = document.getElementById("preview");

  let imageData = "";

  // preview + convert to url
  imgInput.onchange = () => {
    const file = imgInput.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = e => {
      imageData = e.target.result; // data:image/...
      preview.src = imageData;
      preview.style.display = "block";
    };
    reader.readAsDataURL(file);
  };

  window.send = async () => {
    if (!imageData) return alert("à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸à¸£à¸¹à¸›");

    await set(ref(db, "screen"), {
      message: msg.value,
      ig: ig.value,
      image: imageData,
      time: Date.now()
    });

    alert("à¸ªà¹ˆà¸‡à¸ªà¸³à¹€à¸£à¹‡à¸ˆ ğŸ”¥");
  };
</script>

</body>
</html>
